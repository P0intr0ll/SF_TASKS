/*********************************************************** AUTHOR: TOBI ECHEVARRIA* COMPANY: POINTROLL* * CLASS: PRBannerMain** DESCRIPTION: ***********************************************************/package com.pointroll.main{	import pointroll.*;	import pointroll.info.getSWFDimensions;	import com.pointroll.ui.PointRollBannerUI;	import com.pointroll.abstract.PointRollAbstractUI;	import flash.display.MovieClip;	import flash.events.Event;	import flash.events.MouseEvent;	import com.pointroll.events.PRUIEvents;	import com.pointroll.api.utils.net.isLocal;	import com.pointroll.api.data.AdControl;	import com.pointroll.api.events.AdControlEvent;		import com.pointroll.data.PRDataScrapper;	import com.pointroll.events.PRDataScrapeEvents;		import com.pointroll.data.MatchUpData;		import pointroll.datastorage.*;	import pointroll.info.getFolderPath;	public class PRBannerMain extends MovieClip {		private var _ui:PointRollBannerUI;		private var _stageWidth:int;		private var _stageHeight:int;				private var _ac:AdControl;				private var _scrapper:PRDataScrapper;				private var _localTestObject:Object;				private var _xml:XML;				private var _noun:String;		private var _static:String;		public function PRBannerMain() {			addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);		}		// Public Functions		// Private Functions		private function init():void {			pointroll.initAd(this);									_stageWidth =  pointroll.info.getSWFDimensions().width;			_stageHeight =  pointroll.info.getSWFDimensions().height;						_static = pointroll.info.getFolderPath() + (pointroll.getFlashVar("static") || "snickers_manziel_concept3_728x90");			if (isLocal()) {				_localTestObject = new Object();				_localTestObject["varPRCurrTeamName"] = "Pointroll Fantasy";				_localTestObject["varPRJohnnyManziel"] = "TRUE";//"FALSE";				//_localTestObject["Thursday"] = "FALSE";//"FALSE";			}						_ac = new AdControl();			_ac.interfaceID = pointroll.getFlashVar("interfaceID") || "159c4571-e7c7-4ece-b4a4-acfbdb6e343e";			_ac.localTestFile = "SnickersFantasyFootballSmartAd2014.xml";			_ac.addEventListener(AdControlEvent.LOAD_COMPLETE, onAdControlEvent);			_ac.addEventListener(AdControlEvent.LOAD_FAIL, onAdControlEvent);			_ui = new PointRollBannerUI(this);			_ui.addEventListener(PRUIEvents.ON_UI_EVENT , onBannerEvents);						_ac.load();		}		// EVENTS		private function onAddedToStage(e:Event):void {			removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);			init();		}		private function onBannerEvents(e:PRUIEvents):void{			pointroll.launchURL(pointroll.getFlashVar("clickTag1"),true,e.params.noun);					}		private function onAdControlEvent(e:AdControlEvent):void{						trace("\n_ac.getXMLData: "+_ac.getXMLData());			trace(" e.type: " + e.type)			switch(e.type){				case AdControlEvent.LOAD_COMPLETE:					 _xml = _ac.getXMLData();					 if (_xml.NoValue.toLowerCase() == "thursday")											    _scrapper = new PRDataScrapper(["varPRCurrTeamName"], 100 ,15);					 else					    _scrapper = new PRDataScrapper(["varPRCurrTeamName",													    MatchUpData._variableDictionary[String(_xml.NoValue)]],100,15);					trace("_xml.NoValue: " + _xml.NoValue);					trace("MatchUpData._variableDictionary[_xml.NoValue]: " + MatchUpData._variableDictionary[String(_xml.NoValue)]);					//trace("\n  [varPRCurrTeamName]: " +  ["varPRCurrTeamName"])												 _scrapper.addEventListener(PRDataScrapeEvents.ON_DATA_SCRAPE_LOAD, onDataScrapperEvent); 					 _scrapper.addEventListener(PRDataScrapeEvents.ON_DATA_SCRAPE_FAIL, onDataScrapperEvent); 					 					 					_scrapper.load();										 					 				break;				case AdControlEvent.LOAD_FAIL:					 _ui.buildUI(_xml, PRDataScrapeEvents.ON_DATA_SCRAPE_FAIL, _static, true);				break;			}			_ac.removeEventListener(AdControlEvent.LOAD_COMPLETE, onAdControlEvent);			_ac.removeEventListener(AdControlEvent.LOAD_FAIL, onAdControlEvent);		}						private function onDataScrapperEvent(e:PRDataScrapeEvents):void{			trace("\n onDataScrapperEvent: " + e.type);			trace(" e.params: " + e.params)			pointroll.datastorage.setExternalVariable("inputData", _xml.toString());			switch(e.type){				case PRDataScrapeEvents.ON_DATA_SCRAPE_LOAD:						_ui.buildUI(_xml, e.params,true);						gotoAndPlay(2);				break;				case PRDataScrapeEvents.ON_DATA_SCRAPE_FAIL:					 if(isLocal()){					 	_ui.buildUI(_xml,_localTestObject,true);						gotoAndPlay(2);					 }else					 	_ui.buildUI(_xml, PRDataScrapeEvents.ON_DATA_SCRAPE_FAIL, _static, true);				break;			}						_scrapper.removeEventListener(PRDataScrapeEvents.ON_DATA_SCRAPE_LOAD, onDataScrapperEvent); 			_scrapper.removeEventListener(PRDataScrapeEvents.ON_DATA_SCRAPE_FAIL, onDataScrapperEvent); 		}	}}